<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MCD Medical Network - Ø´Ø¨ÙƒØ© Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø·Ø¨ÙŠØ©</title>
<style>
:root { --mcd-red: #c8102e; --mcd-yellow: #ffc72c; }
body { font-family: 'Segoe UI', Tahoma, sans-serif; margin:0; background:#f9f9f9; direction: rtl; }
header { background: var(--mcd-red); padding: 20px; text-align: center; color: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
.ai-box { background: white; width: 90%; max-width: 800px; margin: 20px auto; padding: 20px; border-radius: 12px; border-right: 8px solid var(--mcd-yellow); box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
.search-row { display: flex; gap: 10px; }
.search-row input { flex: 1; padding: 12px; border-radius: 8px; border: 1px solid #ddd; outline: none; }
.search-row button { padding: 12px 25px; background: var(--mcd-red); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
.buttons { margin: 15px 0; display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; }
.buttons button { padding: 12px 20px; font-weight: bold; background: #fff; border: 1px solid #ddd; border-radius: 50px; cursor: pointer; transition: 0.3s; }
.buttons button.active { background: var(--mcd-yellow); border-color: var(--mcd-yellow); transform: scale(1.05); }
.filters { background: white; padding: 15px; margin: 0 auto 20px; width: 90%; max-width: 800px; border-radius: 12px; display: none; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
.filters-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
select { padding: 10px; border-radius: 8px; border: 1px solid #ddd; width: 100%; background: #fff; }
#results { width: 90%; max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; padding-bottom: 50px; }
.card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border-top: 6px solid var(--mcd-red); position: relative; }
.card h3 { margin: 0 0 10px; color: var(--mcd-red); font-size: 18px; }
.class-tag { background: #fef3c7; color: #92400e; padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: bold; position: absolute; left: 15px; top: 15px; }
.card p { margin: 8px 0; font-size: 14px; color: #444; }
.btn-call { display:block; margin-top:10px; text-align:center; background:#28a745; color:white; padding:10px; border-radius:8px; text-decoration:none; font-weight:bold; }
.btn-map { display:block; margin-top:5px; text-align:center; background:#007bff; color:white; padding:10px; border-radius:8px; text-decoration:none; font-weight:bold; }
.status-msg { text-align: center; padding: 50px; color: #777; grid-column: 1/-1; }
</style>
</head>
<body>

<header><h1>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø·Ø¨ÙŠØ© MCD</h1></header>

<div class="ai-box">
    <div class="search-row">
        <input type="text" id="userInput" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„ØªØ®ØµØµ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©..." oninput="freeSearch()" />
        <button onclick="freeSearch()">Ø¨Ø­Ø«</button>
    </div>
</div>

<div class="buttons">
    <button onclick="setTab('Ø§Ù„Ø¹ÙŠØ§Ø¯Ø§Øª', this)">Ø¹ÙŠØ§Ø¯Ø§Øª ÙˆÙ…Ø³ØªØ´ÙÙŠØ§Øª</button>
    <button onclick="setTab('Ø§Ù„ØµÙŠØ¯Ù„ÙŠØ§Øª', this)">ØµÙŠØ¯Ù„ÙŠØ§Øª</button>
    <button onclick="setTab('Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„', this)">Ù…Ø¹Ø§Ù…Ù„ ØªØ­Ø§Ù„ÙŠÙ„</button>
    <button onclick="setTab('Ù…Ø±Ø§ÙƒØ² Ø§Ù„Ø£Ø´Ø¹Ø©', this)">Ù…Ø±Ø§ÙƒØ² Ø£Ø´Ø¹Ø©</button>
</div>

<div class="filters" id="filtersDiv">
    <div class="filters-grid">
        <select id="f-class" onchange="applyFilters()"><option value="">-- Ø§Ù„ÙØ¦Ø© --</option></select>
        <select id="f-spec" onchange="applyFilters()"><option value="">-- Ø§Ù„ØªØ®ØµØµ --</option></select>
        <select id="f-prov" onchange="onProvChange()"><option value="">-- Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© --</option></select>
        <select id="f-area" onchange="applyFilters()"><option value="">-- Ø§Ù„Ù…Ù†Ø·Ù‚Ø© --</option></select>
    </div>
</div>

<div id="results"><p class="status-msg">Ø§Ø®ØªØ± Ù‚Ø³Ù…Ø§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p></div>

<script>
// ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ ID Ù„ÙŠØ¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø´ÙŠØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø©
const SHEET_ID = '1vQxN5MBEUuS0ekIhjpIZmX67soIFFpykCQZJN_ZSuk71lWWTuZZamex8BOPz7nRdGFWPiem6wnJm0ji';

let fullData = [];

async function fetchData(sheetName) {
    // Ù†Ø³ØªØ®Ø¯Ù… ØµÙŠØºØ© CSV Ù„Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(sheetName)}`;
    try {
        const response = await fetch(url);
        const text = await response.text();
        const rows = text.split('\n').slice(1);
        return rows.map(row => {
            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªÙ†ØµÙŠØµ
            const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/^"|"$/g, ''));
            return {
                type: cols[0], class: cols[1], spec: cols[2], name: cols[3],
                prov: cols[4], area: cols[5], addr: cols[6], phone: cols[7], map: cols[8]
            };
        }).filter(item => item.name);
    } catch (e) {
        console.error("Ø®Ø·Ø£:", e);
        return [];
    }
}

async function setTab(sheetName, btn) {
    document.getElementById('results').innerHTML = '<p class="status-msg">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>';
    document.querySelectorAll('.buttons button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    
    fullData = await fetchData(sheetName);
    document.getElementById('filtersDiv').style.display = 'block';

    updateSelect('f-class', [...new Set(fullData.map(i => i.class))]);
    updateSelect('f-spec', [...new Set(fullData.map(i => i.spec))]);
    updateSelect('f-prov', [...new Set(fullData.map(i => i.prov))]);
    
    render(fullData);
}

function updateSelect(id, list) {
    const el = document.getElementById(id);
    const firstOption = el.options[0].text;
    el.innerHTML = `<option value="">${firstOption}</option>` + 
        list.filter(x => x).sort().map(i => `<option value="${i}">${i}</option>`).join('');
}

function onProvChange() {
    const p = document.getElementById('f-prov').value;
    const filteredByProv = fullData.filter(i => !p || i.prov === p);
    updateSelect('f-area', [...new Set(filteredByProv.map(i => i.area))]);
    applyFilters();
}

function applyFilters() {
    const cls = document.getElementById('f-class').value;
    const spc = document.getElementById('f-spec').value;
    const prv = document.getElementById('f-prov').value;
    const are = document.getElementById('f-area').value;

    const res = fullData.filter(i => {
        return (!cls || i.class === cls) &&
               (!spc || i.spec === spc) &&
               (!prv || i.prov === prv) &&
               (!are || i.area === are);
    });
    render(res);
}

function render(list) {
    const div = document.getElementById('results');
    if(!list.length) { div.innerHTML = '<p class="status-msg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….</p>'; return; }
    
    div.innerHTML = list.map(i => `
        <div class="card">
            ${i.class ? `<span class="class-tag">ÙØ¦Ø© ${i.class}</span>` : ''}
            <h3>${i.name}</h3>
            <p><b>Ø§Ù„ØªØ®ØµØµ:</b> ${i.spec || 'Ø¹Ø§Ù…'}</p>
            <p><b>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</b> ${i.prov || ''} - ${i.area || ''} <br> ${i.addr || ''}</p>
            ${i.phone ? `<a href="tel:${i.phone}" class="btn-call">ğŸ“ Ø§ØªØµØ§Ù„: ${i.phone}</a>` : ''}
            ${i.map ? `<a href="${i.map}" target="_blank" class="btn-map">ğŸ“ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</a>` : ''}
        </div>
    `).join('');
}

function freeSearch() {
    const v = document.getElementById('userInput').value.toLowerCase();
    const res = fullData.filter(i => 
        (i.name && i.name.toLowerCase().includes(v)) || 
        (i.area && i.area.toLowerCase().includes(v))
    );
    render(res);
}
</script>
</body>
</html>